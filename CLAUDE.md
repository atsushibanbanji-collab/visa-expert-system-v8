# CLAUDE.md - 絶対遵守事項

> **このファイルに記載されたルールは絶対である。**
> **例外は認めない。違反は許容しない。**

---

## 🚨 最重要原則：ルールファイルは聖典である

本プロジェクトはエキスパートシステムである。
ルールファイル（ナレッジベース）は**絶対的な真実**として扱うこと。

### ルールファイルに対する姿勢

1. **ルールファイルの内容は神聖不可侵である**
   - ルールファイルに定義された内容を勝手に解釈してはならない
   - ルールファイルに書かれていないことを推測で補ってはならない
   - ルールファイルの意図を「こうだろう」と忖度してはならない

2. **ルールファイルへの変更は慎重に**
   - 変更が必要な場合、必ず事前に報告し承認を得ること
   - 変更する場合は、影響を受ける全てのルールを洗い出すこと
   - 一箇所の変更が他のルールと矛盾しないか必ず検証すること

3. **ルールファイルに矛盾・曖昧さを発見した場合**
   - 勝手に解釈して進めることは**絶対禁止**
   - 必ず作業を停止し、人間に確認を求めること
   - 「おそらくこういう意図だろう」という推測での実装は許可しない

---

## 🚫 絶対禁止事項（対症療法の完全排除）

以下の行為は**いかなる理由があっても禁止**する。
「動けばいい」「時間がない」「軽微な問題」は言い訳にならない。

### 禁止行為一覧

| 禁止行為 | 具体例 |
|---------|-------|
| エラーの握りつぶし | `try-catch` で例外を無視する、エラーを `console.log` だけで済ませる |
| 条件分岐での回避 | `if (特定のケース) return;` で問題を迂回する |
| ハードコーディング | 特定の値を直接埋め込んで問題を回避する |
| コピペ修正 | 既存コードをコピーして微修正で対応する |
| 原因不明のまま修正 | 「なぜか動いた」「とりあえず直った」という状態で完了とする |
| 推測による実装 | ルールファイルに書かれていない挙動を勝手に実装する |
| 部分的な修正 | 根本原因を放置して表面的な症状だけ消す |

### 違反を検出した場合

自分（Claude）が上記の禁止行為をしようとしていることに気づいた場合：

1. **即座に手を止める**
2. **なぜその対症療法をしようとしたか分析する**
3. **根本的な解決策を再検討する**
4. **人間に状況を報告し、方針を確認する**

---

## 📋 作業プロトコル（必須手順）

### Phase 1: 分析（コードを書く前に必ず実行）

以下の分析が完了するまで、**一切のコード変更は禁止**：

```
□ 1. 問題の正確な再現条件を特定した
□ 2. 根本原因を特定した（推測ではなく確証を持って）
□ 3. 関連するルールファイルの該当箇所を全て確認した
□ 4. 同様の問題が発生しうる他の箇所を洗い出した
□ 5. 根本原因がルールファイルにあるのか、実装にあるのか切り分けた
```

### Phase 2: 方針提示（承認を得る）

分析結果を以下のフォーマットで報告し、**承認を得てから**次に進む：

```markdown
## 分析結果

### 根本原因
[なぜこの問題が発生しているのか]

### 影響範囲
[この問題が影響する範囲、同様の問題が潜在する箇所]

### 解決方針
[どのように根本解決するか]

### ルールファイルへの影響
[ルールファイルの変更が必要か、必要ならどの部分か]

### 確認事項
[人間に判断を仰ぎたい点]
```

### Phase 3: 実装（承認後のみ）

承認を得た方針に**厳密に従って**実装する。
方針から逸脱する必要が生じた場合は、再度Phase 2に戻る。

### Phase 4: 検証（実装後に必ず実行）

```
□ 1. 修正が根本原因を解決していることを確認した
□ 2. 対症療法的な回避をしていないことを確認した
□ 3. ルールファイルとの整合性を確認した
□ 4. 同様の問題が他で発生しない設計になっていることを確認した
□ 5. 新たな矛盾やエッジケースを生んでいないことを確認した
```

---

## 🔍 エキスパートシステム固有のルール

### ルールの一貫性

- 新しいルールを追加する際は、既存の全ルールとの整合性を検証すること
- ルール間で優先順位の矛盾がないことを確認すること
- 同じ入力に対して異なる結論が導かれる可能性がないことを確認すること

### 推論の透明性

- 推論過程は必ず追跡可能な形で実装すること
- 「なぜその結論に至ったか」を説明できない実装は禁止
- ブラックボックス的な処理は許可しない

### 境界条件の扱い

- エッジケースを発見した場合、握りつぶさずに報告すること
- 境界条件での挙動はルールファイルに明記されていなければ人間に確認すること
- 「たぶん大丈夫」という判断は禁止

---

## ⚠️ 迷ったときの行動指針

判断に迷った場合、以下の優先順位で行動すること：

1. **作業を停止する**（推測で進めない）
2. **人間に質問する**（恥ずかしいことではない）
3. **選択肢を提示する**（判断を仰ぐ）

**「わからない」は恥ではない。「わからないまま進める」ことが罪である。**

---

## 📜 誓約

このプロジェクトで作業を行う際、以下を誓約する：

- 私はルールファイルを絶対的な真実として尊重します
- 私は対症療法を行いません
- 私は推測で実装を進めません
- 私は不明点があれば必ず確認します
- 私は根本原因を特定してから修正に着手します
- 私はこのCLAUDE.mdの全ての規定を遵守します

---

**このファイルは法である。解釈の余地はない。遵守せよ。**
